#!/bin/sh

# SYNOPSIS
#   workspacerc - workspace init file for x sessions

wksplog="$TMP/workspacerc-`date +%s`.log"

launch() {
  cmd="$1"; shift;
  if ! killall -0 "$cmd"; then
    if type "$cmd"; then
      echo "launching '$cmd' '$@'" >> "$wksplog"
      "$cmd" "$@" &
    fi
  fi
}

# NOTE
# Also see .xinitrc for daemons started early before the desktop environment
{
  i3-layout-manager -a

  wpset &

  pgrep -f mark_last_window || mark_last_window &

  unclutter  -idle 5 &
  autocutsel --fork &
  copyq &
  laptop-detect && numlockx off &

  launch xflux -l 48.1439 -g 17.1097 &

  launch firefox &>/dev/null &
  launch evolution &>/dev/null &
  launch spotify &
  launch slack &

  test -d ~/projects/dropbox-dist &&
    launch ~/projects/dropbox-dist/dropboxd &

  nice -n 0 urxvtd -q -f -o &
  launch qterm &

  xrandr --dpi 96

  sleep 10 && ~/.config/xsetrc
} >> "$wksplog" 2>&1 &

